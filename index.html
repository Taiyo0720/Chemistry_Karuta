<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ã‹ã‚‹ãŸã‚¢ãƒ—ãƒªï¼ˆå¯¾æˆ¦å‹ï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
      background: #f7f7fb;
      margin: 0;
      padding: 16px;
      text-align: center;
    }
    h1 { margin-bottom: 8px; }

    #score {
      display: flex;
      justify-content: space-around;
      margin: 12px 0;
      font-weight: bold;
      font-size: 1.1rem;
    }

    #yomi {
      font-size: 1.3rem;
      margin: 14px 0;
      padding: 12px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }

    .card {
      background: #ffffff;
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: transform 0.1s, background 0.1s;
    }

    .card:hover { transform: translateY(-2px); background: #eef2ff; }
    .card.player { background: #c7f9cc; cursor: default; }
    .card.com { background: #ffd6d6; cursor: default; }

    #status { margin-top: 12px; font-weight: bold; }

    button {
      margin-top: 18px;
      padding: 10px 22px;
      font-size: 1rem;
      border: none;
      border-radius: 999px;
      background: #6366f1;
      color: #fff;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>ã‹ã‚‹ãŸå¯¾æˆ¦ï¼ˆã‚ãªãŸ vs COMï¼‰</h1>

  <div id="score">
    <div>ã‚ãªãŸï¼š<span id="playerScore">0</span></div>
    <div>COMï¼š<span id="comScore">0</span></div>
  </div>

  <div id="yomi">ã‚¹ã‚¿ãƒ¼ãƒˆã‚’æŠ¼ã—ã¦ãã ã•ã„</div>
  <div class="cards" id="cards"></div>
  <div id="status"></div>
  <button onclick="startGame()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>

  <script>
    const karuta = [
      { yomi: "ãƒ™ãƒ³ã‚¼ãƒ³", tori: "benzene", img: "images/benzene.png" },
      { yomi: "ãƒˆãƒ«ã‚¨ãƒ³", tori: "toluene", img: "images/toluene.png" },
      { yomi: "ãƒ•ã‚§ãƒãƒ¼ãƒ«", tori: "phenol", img: "images/phenol.png" },
      { yomi: "å®‰æ¯é¦™é…¸", tori: "benzoic acid", img: "images/benzoicAcid.png" },
      { yomi: "ãƒŠãƒ•ã‚¿ãƒ¬ãƒ³", tori: "naphthalene", img: "images/naphthalene.png" },
    ];


    let remaining = [];
    let current = null;
    let playerScore = 0;
    let comScore = 0;
    let comTimer = null;

    const yomiEl = document.getElementById("yomi");
    const cardsEl = document.getElementById("cards");
    const statusEl = document.getElementById("status");
    const playerScoreEl = document.getElementById("playerScore");
    const comScoreEl = document.getElementById("comScore");

    function startGame() {
      remaining = [...karuta];
      playerScore = 0;
      comScore = 0;
      updateScore();
      statusEl.textContent = "";
      drawCards();
      nextRound();
    }

    function drawCards() {
      cardsEl.innerHTML = "";
      karuta.forEach(item => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
          <img src="${item.img}" style="width:100%; border-radius:8px;">
          <div style="margin-top:6px;">${item.tori}</div>
        `;
        div.onclick = () => selectCard(item, div);
        cardsEl.appendChild(div);
      });
    }

    function nextRound() {
      if (remaining.length === 0) {
        yomiEl.textContent = "ã‚²ãƒ¼ãƒ çµ‚äº†ï¼";
        if (playerScore > comScore) statusEl.textContent = "ã‚ãªãŸã®å‹ã¡ ğŸ‰";
        else if (playerScore < comScore) statusEl.textContent = "COMã®å‹ã¡ ğŸ˜ˆ";
        else statusEl.textContent = "å¼•ãåˆ†ã‘ ğŸ¤";
        return;
      }

      const index = Math.floor(Math.random() * remaining.length);
      current = remaining[index];
      yomiEl.textContent = current.yomi;

      // COMãŒå–ã‚‹ã¾ã§ã®åå¿œæ™‚é–“ï¼ˆé›£æ˜“åº¦èª¿æ•´å¯ï¼‰
      const comDelay = 800 + Math.random() * 1000; // 0.8ã€œ1.8ç§’
      clearTimeout(comTimer);
      comTimer = setTimeout(comTake, comDelay);
    }

    function selectCard(item, element) {
      if (item !== current) {
        statusEl.textContent = "ã¡ãŒã„ã¾ã™";
        setTimeout(() => statusEl.textContent = "", 500);
        return;
      }
      if (element.classList.contains("player") || element.classList.contains("com")) return;

      clearTimeout(comTimer);
      element.classList.add("player");
      playerScore++;
      statusEl.textContent = "ã‚ãªãŸãŒå–ã‚Šã¾ã—ãŸï¼";
      endRound();
    }

    function comTake() {
      const cards = document.querySelectorAll('.card');
      cards.forEach(card => {
        if (card.textContent === current.tori) {
          card.classList.add('com');
        }
      });
      comScore++;
      statusEl.textContent = "COMãŒå–ã‚Šã¾ã—ãŸ";
      endRound();
    }

    function endRound() {
      updateScore();
      remaining = remaining.filter(k => k !== current);
      setTimeout(() => {
        statusEl.textContent = "";
        nextRound();
      }, 900);
    }

    function updateScore() {
      playerScoreEl.textContent = playerScore;
      comScoreEl.textContent = comScore;
    }
  </script>
</body>
</html>
